<div class="card border-0 shadow-sm mb-4 upload-card">
  <div class="card-body p-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h5 class="card-title mb-0">Upload Files</h5>
      <button type="button" class="btn-close" (click)="cancel()"></button>
    </div>

    <div
      class="upload-area"
      [class.active]="isDragging || files.length > 0"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
      (click)="fileInput.click()"
    >
      <input
        #fileInput
        type="file"
        multiple
        class="d-none"
        (change)="onFileSelected($event)"
      >

      <div *ngIf="files.length === 0">
        <i class="fa-solid fa-cloud-arrow-down text-primary" style="font-size: 3rem;"></i>
        <h5 class="mt-3">Drag and drop files here</h5>
        <p class="text-muted">or click to browse</p>
      </div>

      <div *ngIf="files.length > 0 && !isUploading" class="w-100">
        <h5 class="mb-3">Selected Files ({{files.length}})</h5>

        <div class="selected-files">
          <div *ngFor="let file of files; let i = index" class="selected-file d-flex align-items-center mb-2">
            <i class="bi" [ngClass]="getFileIconClass(file)"></i>
            <span class="ms-2 me-auto text-truncate">{{file.name}}</span>
            <span class="text-muted ms-2">{{formatFileSize(file.size)}}</span>
            <button type="button" class="btn-close ms-2" (click)="removeFile(i, $event)"></button>
          </div>
        </div>
      </div>

      <div *ngIf="isUploading" class="w-100 text-center">
        <div class="spinner-border text-primary mb-3" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <h5>Compressing files...</h5>
        <div class="progress mt-3">
          <div
            class="progress-bar"
            [style.width.%]="uploadProgress"
            role="progressbar"
            [attr.aria-valuenow]="uploadProgress"
            aria-valuemin="0"
            aria-valuemax="100"
          ></div>
        </div>
        <p class="text-muted mt-2">Please wait while we process your files</p>
      </div>
    </div>

    <div class="d-flex justify-content-end mt-3" *ngIf="files.length > 0 && !isUploading">
      <button type="button" class="btn btn-outline-secondary me-2" (click)="cancel()">
        Cancel
      </button>
      <button type="button" class="btn btn-primary" (click)="uploadFiles()">
        Create Archive
      </button>
    </div>
  </div>
</div>
